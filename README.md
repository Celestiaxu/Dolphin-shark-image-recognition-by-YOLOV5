# 海豚/鲨鱼图像识别模型 & 简单网页接口实现

这是一个基于YOLOV5训练的海豚/鲨鱼图像识别模型，附带简易实现的flask网页接口与日志功能。此为算法实习期间完成的小项目，模型精准度和泛用性有待提高，仅作为练习实例上传，作为记录。


代码使用：
---
1. 配置YOLOV5模型以及flask运行环境  
  https://github.com/ultralytics/yolov5<br>  https://tutorial.helloflask.com/hello/<br>
   除此之外，```web.py```中还使用了```re``` ```subprocess``` ```ffmpeg```等库，均需要部署。
   
2. 在对应文件夹导入训练好的模型文件以及网页接口文件（dataset文件夹为图片训练集，仅作参考）

3. 在命令行输入以获得网页链接：
```Python
flask --app web run
```
4. 在浏览器中输入网页链接，例如``http://127.0.0.1:5000``，并上传图像或视频，后台处理完成后会显示在网页上。（注意：视频处理时间较长，涉及算法识别和转码，网页并未设置进度条或其他提示，需要耐心等待反馈。）
   
5. 日志将海豚视作正常识别对象（蓝色标记框），鲨鱼为异常识别对象（红色标记框），输出为``output.txt``。
   

实习过程记录与总结
---
1. 数据库源自网络图片，训练用的label均为手动标记，使用的网站是```https://www.makesense.ai/```。数据集总量不足且训练的两种生物形态较为相似，因此训练效果不太理想，后续优化方向是增加数据集大小，以及增加训练轮数，由于电脑无GPU，训练100+张图片50轮已占用超过一小时时长，故先止步于此。
   
2. 初次训练时显示训练失败，改用自带的另一个权重文件```yolov5n.pt```解决了这个问题，怀疑是下载模型的时候默认的```yolov5s.pt```文件损坏了。

3. 后端框架的开发过程遇到的问题主要是处理好的图像和视频在网页显示失败的问题。后面发现实际问题有二：1.flask网页显示本地文件夹的图像和视频只能通过```static```文件夹，放在其他文件夹里的无法显示，因此需要在```yolov5```文件夹里新建```static```文件夹；2.经YOLOV5模型处理过的视频格式特殊，而chrome/edge浏览器并不支持这个格式，必须用```ffmpeg```库来转码为```h264```格式，才能正常播放。

4. 实习的另一个小任务是改变检测框的颜色，并显示坐标，这个主要是参考了```https://blog.csdn.net/dal1223/article/details/126727191```的方法。与里面教程不同的是，决定框颜色的函数```box_label```是在```util```文件夹下的```plotting.py```里的，并不是```plots.py```，网络上也有分享修改其他函数的方法，但经过考证应该是旧版YOLOV5的函数，已经被```box_label```取代。

5. 总结：从模型的部署训练到检测图片和视频，到制作网页接口，修改函数达到预期的识别效果，再到研究github的使用方法上传代码，这是不断探索和学习的过程，我从中受益许多。当然这个项目仍有许多不严谨处，权当是对于图像识别算法和前端开发的一次小尝试。体验完整的开发流程对于今后的学习和开发工作将大有裨益。






